<!DOCTYPE html>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script type="text/javascript" src="jquery/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="jquery/jquery-ui-1.10.0.custom.min.js"></script>
<script type="text/javascript" src="select2/select2-3.5.2/select2.min.js"></script>
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
<link type="text/css" href="css/checkmate.css" rel="stylesheet" />
<link type="text/css" href="jquery/css/ui-lightness/jquery-ui-1.10.0.custom.css" rel="stylesheet" />
<link type="text/css" href="select2/select2-3.5.2/select2.css" rel="stylesheet" />
<script type="text/javascript" src="js/global_start.js"></script>
<script type="text/javascript" src="js/resourceful.js"></script>
<script type="text/javascript">
	$(window).load(function() {
		
		//This script extracts parameters from the URL
		//from jquery-howto.blogspot.com
		$.extend({
			getUrlVars : function() {
				var vars = [], hash;
				var hashes = window.location.href.slice(
						window.location.href.indexOf('?') + 1).split('&');
				for ( var i = 0; i < hashes.length; i++) {
					hash = hashes[i].split('=');
					vars.push(hash[0]);
					vars[hash[0]] = hash[1];
				}
				return vars;
			},
			getUrlVar : function(name) {
				return $.getUrlVars()[name];
			}
		});
		
		//#######################################################################################################
		/**
		 * 'id' should be resource's unique id. 
		 * Backend stuff should actually happen here to return the resource data.
		 * For now, zenbu wa hado codo (everything's hardcoded)
		 */
		//#######################################################################################################
		
		// MAGIC HAPPENS
		/**
		 * 'results' should be sorted by display order, with results[0] displayed first.
		 * Each result item will be of the form:
		 * {
		 * id: 'Resource id'
		 * name: pls
		 * tags: A list of lower-case strings which are the tags.
		 * description: Short description to be shown under the title
		 * fullDescription: Long description of the resource
		 * score: Upvote/downvote score
		 * vote: User's vote (-1, 0, or 1)
		 * rating: Approximate rating of target audience. An array of two integers.
		 * url: External url
		 * favorite: Boolean, true if this result is favorited by the logged-in user 
		 * reviews: An object containing information about reviews.
		 *   {
		 *   rid: 'Review id'
		 *   text: Review text
		 *   author: Author's username
		 *   uuid: Author's 'unique username id'
		 *   }
		 */
		
		resourceInfo = {id: 1337420,
		name: "A Primer to Caro-Kann",
		tags: ["openings","caro-kann","intermediate"],
		description: "This is an intermediate-level introduction to the Caro-Kann Defense.",
		fullDescription: "This is an intermediate-level introduction to the Caro-Kann Defense, "+
		"which begins with 1e4 c6. Players can use this reference to develop a stronger pawn "+
		"structure following the opening move.",
		score: 0,
		vote: 0,
		rating: [1200,1400],
		url: "google.com",
		favorite: false,
		reviews:
		[
			{
			rid: 0,
			text: "A top quality introduction to a less common but powerful opening. Great for intermediates.",
			author: "infinitestory",
			uuid: 0
			}
		]
		}
		
		placeTopOfPage();
		
		$("#add_review_button").click(function() {
            if (!($("#new_review_container").length)) {
                var new_review_box = $('<div>').attr("id", "new_review_container").append($('<textarea>').attr("id","new_review_text").css("width", "50%"));
                new_review_box.hide();
                $("#reviews_container").prepend(new_review_box);
                new_review_box.slideDown();
                $("#add_review_button").attr("value", "Submit review");
            }
            else if ($("#new_review_text").val() != ""){
                $("#new_review_container").after($('<div>').attr("class", "review").append('<div class="review_image">\n<img src="./assets/pawn_avatar.png" width="80px" height="80px"/ style="margin:10px; padding:10px; border-radius:2px; border: 2px solid gainsboro;">\n</div>')
                    .append($('<div>').attr("class", "review_text").append(
                        $('<p>').html($("#new_review_text").val())).append(
                        $('<p>').attr("class", "authordata").html("by infinitestory, 4/20/15")
                    )))
                $("#new_review_container").slideUp(400, function() {$("#new_review_container").remove()});
                $("#add_review_button").attr("value", "Add new review");
            }
        })
		
		
		var drawPage = function() {
			$(".summarycontainer *").remove();
			$(".summarycontainer").append("<div class=\"resourcetitle\"><span class=\"largefocus\"><strong>"+resourceInfo.description+"</strong></span></div>");
			$(".summarycontainer").append("<div class=\"tagsiconsrow\"/>");
			var tagsstring = ""
			for (var i=0; i<resourceInfo.tags.length-1; i++) {
				tagsstring+=resourceInfo.tags[i];
				tagsstring+=", ";
			}
			if (resourceInfo.tags.length > 0) {
				tagsstring+=resourceInfo.tags[resourceInfo.tags.length-1];
			}
			$(".summarycontainer .tagsiconsrow").append("<div class=\"resource_tags\"><p><strong>Tags:</strong>"+tagsstring+"</p></div>");
			$(".summarycontainer .tagsiconsrow").append("<div class=\:rightcol\"><div class=\"resource_header scorepanel\"></div></div>");
			$(".summarycontainer .tagsiconsrow").append("<div class=\"resource_header extlinkpanel\"></div>");
			$(".summarycontainer .extlinkpanel").append("<a href=\""+resourceInfo.url+"\">"+extlink_button_html+"</a>");
			$(".summarycontainer .tagsiconsrow").append("<div class=\"resource_header heartpanel\"><div id=\"cp_button3\" class=\"heart_button\"></div></div>");
			
		}
		
		/*
<div class="summary_page">
<div class="summarycontainer" style="height:auto;padding:30px;">
    <div style = "margin-top:50px; margin-bottom:15px;text-align:center;">
		<span class="largefocus"><strong>A Primer to Caro-Kann</strong></span>
    </div>
    <div class="tagsiconsrow">
	<div class="resource_tags">
		<p><strong>Tags:</strong> opening, Caro-Kann, defense, online, free</p>
	</div>
	<div class="rightcol">
	<div class="resource_header scorepanel">
		<div>
			<span> +35</span>
		</div>
		<div class="scorebuttons">
			<span class="ui-icon ui-icon-triangle-1-n"></span>
			<span class="ui-icon ui-icon-triangle-1-s"></span>
		</div>
	</div>
	<div class="resource_header extlinkpanel">
		<a href="https://www.google.com/"><img width="32px" height="32px" src="./assets/extlink.png" onmouseover="this.src='./assets/extlink_shadow.png'" onmouseout="this.src='./assets/extlink.png'"></a>
	</div>
    <div class="resource_header heartpanel">
		<div id="cp_button3" class="heart_button"></div>
	</div> <-- GOT HERE ##########################################################
	<hr width="100%" size="1" style="margin:0px; color:gainsboro;"></hr>
	<div class="resource_header ratingpanel" style="text-align:center;">
		<span><span title="FIDE chess skill rating" style="vertical-align:center;"><strong>Elo Rating:</strong><span class="ui-icon ui-icon-help" style="display:inline-block; vertical-align:center;"></span></span>  ~1600</span>
	</div>
</div>
</div>
	<hr width="100%" size="2" style="margin-top:20px; margin-bottom:20px; color:gainsboro;"></hr>
	<div class="description">
		<span>This is an intermediate-level introduction to the Caro-Kann Defense, which begins with 1e4 c6.  Players can use this reference to develop a stronger pawn structure following the opening move.</span>
	</div>
	<hr width="100%" size="2" style="margin-top:20px; margin-bottom:20px; color:gainsboro;"></hr>
	
	<span><strong>Reviews: </strong><input type = "button" id = "add_review_button" value="Add review"></input></span>
	
	<div class="summary_page_section" id="reviews_container" style="border-bottom:none;margin-top:10px;">
		<div class="review">
			<div class="review_image">
				<img src="./assets/pawn_avatar.png" width="80px" height="80px"/ style="margin:10px; padding:10px; border-radius:2px; border: 2px solid gainsboro;">
			</div>
			<div class="review_text">
				<p>A top quality introduction to a less common but powerful opening.  Great for intermediates.</p>
				<p class="authordata">by infinitestory, 4/20/15</p>
			</div>
		</div>
		<div class="review">
			<div class="review_image">
				<img src="./assets/pawn_avatar.png" width="80px" height="80px"/ style="margin:10px; padding:10px; border-radius:2px; border: 2px solid gainsboro;">
			</div>
			<div class="review_text">
				<p>A top quality introduction to a less common but powerful opening.  Great for intermediates.</p>
				<p class="authordata">by infinitestory, 4/20/15</p>
			</div>
		</div>
	</div>
</div>
</div>
		*/
		
		var drawHeartButton = function() {
			if (resourceInfo.favorite) {
				$(".heart_button").append(heart_button_filled_html);
				
			} else {
				$(".heart_button").append(heart_button_html);
			}
			$(".heartbutton").click(function() {
				resourceInfo.favorite = !resourceInfo.favorite;
				$(".heart_button *").remove();
				drawHeartButton();
			});
		}
		
		var drawScorePanel = function() {
			$(".scorepanel *").remove();
			$(".scorepanel").append("<div><span>+"+resourceInfo.score+"</span></div>");
			$(".scorepanel").append("<div class=\"scorebuttons\"></div>");
			if (resourceInfo.vote == 0) {
				$(".scorebuttons").append("<div>"+up_button_html+"</div><div>"+down_button_html+"</div>");
			} else if (resourceInfo.vote == 1) {
				$(".scorebuttons").append("<div>"+up_button_filled_html+"</div><div>"+down_button_html+"</div>");
			} else {
				$(".scorebuttons").append("<div>"+up_button_html+"</div><div>"+down_button_filled_html+"</div>");
			}
			$(".upbutton:last").click(function() {
				if (resourceInfo.vote == 1) {
					resourceInfo.score-=resourceInfo.vote;
					resourceInfo.vote = 0;
					resourceInfo.score+=resourceInfo.vote;
				} else {
					resourceInfo.score-=resourceInfo.vote;
					resourceInfo.vote = 1;
					resourceInfo.score+=resourceInfo.vote;
				}
				drawScorePanel();
			});
			$(".downbutton:last").click(function() {
				if (resourceInfo.vote == -1) {
					resourceInfo.score-=resourceInfo.vote;
					resourceInfo.vote = 0;
					resourceInfo.score+=resourceInfo.vote;
				} else {
					resourceInfo.score-=resourceInfo.vote;
					resourceInfo.vote = -1;
					resourceInfo.score+=resourceInfo.vote;
				}
				drawScorePanel();
			});
		}
        
        $( document ).tooltip({
            track: true
        });
		
		drawHeartButton();
		drawScorePanel();
		
	});
</script>
</head>
<body>


<div class="summary_page">
	<div class="summarycontainer" style="height:auto;padding:30px;">
    <div style = "margin-top:50px; margin-bottom:15px;text-align:center;">
		<span class="largefocus"><strong>A Primer to Caro-Kann</strong></span>
    </div>
    <div class="tagsiconsrow">
	<div class="resource_tags">
		<p><strong>Tags:</strong> opening, Caro-Kann, defense, online, free</p>
	</div>
	<div class="rightcol">
	<div class="resource_header scorepanel">
		<div>
			<span> +35</span>
		</div>
		<div class="scorebuttons">
			<span class="ui-icon ui-icon-triangle-1-n"></span>
			<span class="ui-icon ui-icon-triangle-1-s"></span>
		</div>
	</div>
	<div class="resource_header extlinkpanel">
		<a href="https://www.google.com/"><img width="32px" height="32px" src="./assets/extlink.png" onmouseover="this.src='./assets/extlink_shadow.png'" onmouseout="this.src='./assets/extlink.png'"></a>
	</div>
    <div class="resource_header heartpanel">
		<div id="cp_button3" class="heart_button"></div>
	</div>
	<hr width="100%" size="1" style="margin:0px; color:gainsboro;"></hr>
	<div class="resource_header ratingpanel" style="text-align:center;">
		<span><span title="FIDE chess skill rating" style="vertical-align:center;"><strong>Elo Rating:</strong><span class="ui-icon ui-icon-help" style="display:inline-block; vertical-align:center;"></span></span>  ~1600</span>
	</div>
</div>
</div>
	<hr width="100%" size="2" style="margin-top:20px; margin-bottom:20px; color:gainsboro;"></hr>
	<div class="description">
		<span>This is an intermediate-level introduction to the Caro-Kann Defense, which begins with 1e4 c6.  Players can use this reference to develop a stronger pawn structure following the opening move.</span>
	</div>
	<hr width="100%" size="2" style="margin-top:20px; margin-bottom:20px; color:gainsboro;"></hr>
	
	<span><strong>Reviews: </strong><input type = "button" id = "add_review_button" value="Add review"></input></span>
	
	<div class="summary_page_section" id="reviews_container" style="border-bottom:none;margin-top:10px;">
		<div class="review">
			<div class="review_image">
				<img src="./assets/pawn_avatar.png" width="80px" height="80px"/ style="margin:10px; padding:10px; border-radius:2px; border: 2px solid gainsboro;">
			</div>
			<div class="review_text">
				<p>A top quality introduction to a less common but powerful opening.  Great for intermediates.</p>
				<p class="authordata">by infinitestory, 4/20/15</p>
			</div>
		</div>
		<div class="review">
			<div class="review_image">
				<img src="./assets/pawn_avatar.png" width="80px" height="80px"/ style="margin:10px; padding:10px; border-radius:2px; border: 2px solid gainsboro;">
			</div>
			<div class="review_text">
				<p>A top quality introduction to a less common but powerful opening.  Great for intermediates.</p>
				<p class="authordata">by infinitestory, 4/20/15</p>
			</div>
		</div>
	</div>
</div>
</div>

<script type="text/javascript" src="js/global_end.js"></script>
<script type="text/javascript">
	
</script>

</body>
</html>