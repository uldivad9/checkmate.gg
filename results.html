<!DOCTYPE html>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script type="text/javascript" src="jquery/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="jquery/jquery-ui-1.10.0.custom.min.js"></script>
<link type="text/css" href="css/checkmate.css" rel="stylesheet" />
<link type="text/css" href="jquery/css/ui-lightness/jquery-ui-1.10.0.custom.css" rel="stylesheet" />
<script type="text/javascript" src="js/global_start.js"></script>
<script type="text/javascript">
	$(window).load(function() {
		
		//This script extracts parameters from the URL
		//from jquery-howto.blogspot.com
		$.extend({
			getUrlVars : function() {
				var vars = [], hash;
				var hashes = window.location.href.slice(
						window.location.href.indexOf('?') + 1).split('&');
				for ( var i = 0; i < hashes.length; i++) {
					hash = hashes[i].split('=');
					vars.push(hash[0]);
					vars[hash[0]] = hash[1];
				}
				return vars;
			},
			getUrlVar : function(name) {
				return $.getUrlVars()[name];
			}
		});
		
		//console.log($.getUrlVar("tags"));
		
		//#######################################################################################################
		/**
		 * Backend sh*t should actually be happening to determine the search results. 
		 * For now, the results are going to be populated regardless of the tags searched >.>
		 */
		//#######################################################################################################
		
		// MAGIC HAPPENS
		/**
		 * 'results' should be sorted by display order, with results[0] displayed first.
		 * Each result item will be of the form:
		 * {
		 * id: 'Resource id'
		 * name: pls
		 * description: Short description to be shown under the title
		 * score: Upvote/downvote score
		 * vote: User's vote (-1, 0, or 1)
		 * rating: Approximate rating of target audience. An array of two integers.
		 * url: External url
		 * favorite: Boolean, true if this result is favorited by the logged-in user 
			//not sure if this should be calculated backend or frontend
		 */
		searchResults = [
		{id: 1337420,
		name: "Test Resource",
		description: "I am a test resource",
		score: 0,
		vote: 0,
		rating: [1200,1400],
		url: "about:blank",
		favorite: false},
		
		{id: 1337421,
		name: "Test Resource Kai",
		description: "I am also a test resource",
		score: 10,
		vote: 1,
		rating: [1400,1400],
		url: "google.com",
		favorite: true},
		
		{id: 1337421,
		name: "Test Resource Kai Ni",
		description: "This resource was upgraded so much that the text of the description is really long; long enough to require word wrapping.",
		score: -10,
		vote: -1,
		rating: [1000,2000],
		url: "google.com",
		favorite: true},
		]
		//#######################################################################################################
		
		placeTopOfPage();
		
		var placeResult = function(result, i) {
			$("#resultlisting").append("<div class=\"searchresult\">");
			$(".searchresult:last").append("<div class=\"leftcol\"></div><div class=\"rightcol\"></div>");
			$(".leftcol:last").append("<div class=\"name\"></div><div class=\"description\"></div>");
			$(".name:last").append("<span></span>");
			$(".name:last > span").text(result.name);
			$(".description:last").append("<span></span>");
			$(".description:last > span").text(result.description);
			$(".rightcol:last").append("<div class=\"buttonpane\"></div><hr width=\"100%\" size=\"1\" style=\"margin:0px; color:gainsboro;\"></hr><div class=\"rating\"></div>");
			if (searchResults[i].favorite) {
				$(".buttonpane:last").append("<div class=\"button\">"+heart_button_filled_html+"</div>");
			} else {
				$(".buttonpane:last").append("<div class=\"button\">"+heart_button_html+"</div>");
			}
			$(".heartbutton:last").attr("index",i);
			$(".heartbutton:last").click(function() {
				//console.log('refresh');
				searchResults[i].favorite = !searchResults[i].favorite;
				refreshResults();
			});
			$(".buttonpane:last").append("<div class=\"button\"><span class=\"ui-icon ui-icon-extlink\"></span></div><div class=\"scorewidget\"></div>");
			$(".scorewidget:last").append("<div class=\"scorebuttons\"><span class=\"ui-icon ui-icon-triangle-1-n\"></span><span class=\"ui-icon ui-icon-triangle-1-s\"></span></div>");
			$(".scorewidget:last").append("<div class=\"score\"><span></span></div>");
			if (result.score > 0) {
				$(".score:last > span").text("+"+result.score);
			} else {
				$(".score:last > span").text(result.score);
			}
			$(".rating:last").append("<span></span>");
			if (result.rating[0] === result.rating[1]) {
				$(".rating:last > span").text("Rating: ~"+result.rating[0]);
			} else {
				$(".rating:last > span").text("Rating: "+result.rating[0]+"-"+result.rating[1]);
			}
		}
		
		var refreshResults = function() {
			$("#resultlisting *").remove();
			for (var i=0; i<searchResults.length; i++) {
				result = searchResults[i];
				placeResult(result,i);
			}
		}
		
		refreshResults();
		
		$("#logo_main").click(function() {
			window.location.href = "./main.html";
		});
		
	});
</script>
</head>
<body>

<!-- i feel so empty -->

<div style="margin-top:10px">
<div style="width:62%; float:right; visibility:hidden;">inazuma is my waifu</div>
<div style="float:right;">
<span class="large" style="text-transform:capitalize; color:#1C1C1C">Search Results:</span>
</div>
</div>

<div id="resultlisting" class="resultlisting">
	
</div>

<script type="text/javascript" src="js/global_end.js"></script>

</body>
</html>

<!-- KEEP THIS FOR REFERENCE
<div class="searchresult" >
	<div class="leftcol">
		<div class="name">
			<span>
				Openings for Aggression
			</span>
		</div>
		<div class="description">
			<span>
			Description text should go here. Sometimes the text might go on and on, requiring me to write a lot of random filler text to fill this textbox. Asdf asdf asdf asdf.
			</span>
		</div>
	</div>
	<div class="rightcol">
		<div class="buttonpane">
			<div class="button"><span class="ui-icon ui-icon-heart"></span></div>
			<div class="button"><span class="ui-icon ui-icon-extlink"></span></div>
			<div class="scorewidget">
				<div class="scorebuttons">
					<span class="ui-icon ui-icon-triangle-1-n"></span>
					<span class="ui-icon ui-icon-triangle-1-s"></span>
				</div>
				<div class="score">
					<span>+5</span>
				</div>
			</div>
		</div>
		<hr width="100%" size="1" style="margin:0px; color:gainsboro;"></hr>
		<div class="rating">
			<span>Rating: ~1600</span>
		</div>
	</div>
</div>
-->